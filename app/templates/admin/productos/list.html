{% extends "admin/layout_admin.html" %}
{% block title %}Catálogo{% endblock %}
{% block header_title %}Productos Terminados{% endblock %}

{% block content %}
<div class="section-header">
    <div><p style="color: var(--text-muted);">Catálogo de venta y stock disponible</p></div>
    <a href="{{ url_for('admin.productos_create') }}" class="btn-primary">
        <i class="bi bi-tag-fill"></i> Nuevo Producto
    </a>
</div>

<div class="table-container">
    <table class="modern-table">
        <thead>
            <tr>
                <th width="60">Foto</th>
                <th>SKU</th>
                <th>Producto</th>
                <th>Precio Venta</th>
                <th>Stock Disponible</th>
                <th>Lote</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for p in productos %}
            <tr>
                <td>
                    {% if p.foto_path %}
                        <img src="{{ url_for('static', filename='uploads/productos/' + p.foto_path) }}"
                             style="width: 50px; height: 50px; border-radius: 8px; object-fit: cover; border: 1px solid var(--border-color);">
                    {% else %}
                        <div style="width: 50px; height: 50px; background: var(--pale-slate); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--grey-olive);"><i class="bi bi-bag"></i></div>
                    {% endif %}
                </td>
                <td><span style="background: var(--espresso-light); color: var(--espresso); padding: 4px 8px; border-radius: 4px; font-weight: 600; font-size: 0.85rem;">{{ p.codigo_sku }}</span></td>
                <td>
                    <div style="font-weight: 600;">{{ p.nombre }}</div>
                    <div style="font-size: 0.8rem; color: var(--text-muted);">{{ p.descripcion or '' }}</div>
                </td>
                <td style="font-weight: 700; color: var(--text-headers);">${{ p.precio_venta }}</td>
                <td>
                    <span style="font-weight: 700; color: {% if p.cantidad_stock == 0 %}#ef4444{% else %}var(--success){% endif %};">
                        {{ p.cantidad_stock }} pza
                    </span>
                </td>
                <td>{{ p.lote_produccion or '-' }}</td>
                <td>
                    <button class="action-btn" title="Editar"><i class="bi bi-pencil"></i></button>
                    <button class="action-btn" title="Ver Ficha"><i class="bi bi-file-earmark-text"></i></button>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="7" style="text-align: center; padding: 2rem;">No hay productos en el catálogo.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}