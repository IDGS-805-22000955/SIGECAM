{% extends "admin/layout_admin.html" %}
{% block title %}Almacén MP{% endblock %}
{% block header_title %}Materia Prima{% endblock %}

{% block content %}
<div class="section-header">
    <div><p style="color: var(--text-muted);">Inventario de insumos para producción</p></div>
    <a href="{{ url_for('admin.materiales_create') }}" class="btn-primary">
        <i class="bi bi-plus-lg"></i> Nuevo Material
    </a>
</div>

<div class="table-container">
    <table class="modern-table">
        <thead>
            <tr>
                <th width="50">Img</th>
                <th>Código</th>
                <th>Material</th>
                <th>Proveedor</th>
                <th>Existencia</th>
                <th>Costo</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for m in materiales %}
            <tr>
                <td>
                    {% if m.foto_path %}
                        <img src="{{ url_for('static', filename='uploads/materias_primas/' + m.foto_path) }}"
                             style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover;">
                    {% else %}
                        <div style="width: 40px; height: 40px; background: var(--pale-slate); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: var(--grey-olive);"><i class="bi bi-box"></i></div>
                    {% endif %}
                </td>
                <td><span style="font-family: monospace; font-weight: 600; color: var(--espresso);">{{ m.codigo_interno }}</span></td>
                <td>{{ m.nombre }}</td>
                <td>{{ m.proveedor or '-' }}</td>
                <td>
                    <span style="font-weight: 700; color: {% if m.cantidad_stock < 10 %}#ef4444{% else %}var(--success){% endif %};">
                        {{ m.cantidad_stock }} <span style="font-size: 0.8em; font-weight: 400; color: var(--text-muted);">{{ m.unidad_medida }}</span>
                    </span>
                </td>
                <td>${{ m.costo_unitario }}</td>
                <td>
                    <button class="action-btn"><i class="bi bi-pencil"></i></button>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="7" style="text-align: center; padding: 2rem;">No hay materiales registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}